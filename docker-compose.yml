version: "2"
services:  
  master:
    image: intachompoo/jenkins-master:2.1
    container_name: jenkins_master
    ports:
      - "50000:50000"  
      - "8080:8080"
    environment:
      #JNLP_PROTOCOL_OPTS: "-Dorg.jenkinsci.remoting.engine.JnlpProtocol3.disabled=false"
      JAVA_OPTS: "-Djava.awt.headless=true"  
      JAVA_OPTS: "-Djenkins.install.runSetupWizard=false" # Start jenkins unlocked 
    volumes:
      - jenkins-master:/var/jenkins_home
    networks:
      - jenkins-net

  worker:
    image: intachompoo/jenkins-slave:2.1
    container_name: jenkins_slave
    depends_on:
      - master
    environment:
      JENKINS_URL: "http://master:8080"
     # JENKINS_TUNNEL: "master:50000"
      JENKINS_SECRET: "31bc7a67a6527664eabae6de4f576e49511b5c8f3ab838a426d8001b8624d3ef"
      JENKINS_AGENT_NAME: "jnlp-docker-slave"
      JENKINS_AGENT_WORKDIR: "/home/jenkins/agent"
    volumes:
      - jenkins-worker:/var/jenkins_home/worker
    networks:
      - jenkins-net

volumes:
  jenkins-master:
  jenkins-worker:
networks:
  jenkins-net:
